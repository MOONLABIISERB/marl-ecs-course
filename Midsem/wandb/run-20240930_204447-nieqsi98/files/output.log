Episode 0, Avg Reward: 22.77, Total Reward: 204.89, Average Profit: 22.77, Average Distance: 8.09
Episode 100, Avg Reward: 16.95, Total Reward: 152.54, Average Profit: 16.95, Average Distance: 9.06
Episode 200, Avg Reward: 22.26, Total Reward: 200.33, Average Profit: 22.26, Average Distance: 7.65
Episode 300, Avg Reward: 11.60, Total Reward: 104.43, Average Profit: 11.60, Average Distance: 8.55
Episode 400, Avg Reward: 25.84, Total Reward: 232.60, Average Profit: 25.84, Average Distance: 7.05
Episode 500, Avg Reward: 26.43, Total Reward: 237.90, Average Profit: 26.43, Average Distance: 7.45
Episode 600, Avg Reward: 38.73, Total Reward: 348.59, Average Profit: 38.73, Average Distance: 4.49
Episode 700, Avg Reward: 19.78, Total Reward: 178.04, Average Profit: 19.78, Average Distance: 7.43
Episode 800, Avg Reward: 23.45, Total Reward: 211.03, Average Profit: 23.45, Average Distance: 7.19
Episode 900, Avg Reward: 35.36, Total Reward: 318.22, Average Profit: 35.36, Average Distance: 5.33
Episode 1000, Avg Reward: 37.59, Total Reward: 338.31, Average Profit: 37.59, Average Distance: 4.65
Episode 1100, Avg Reward: 9.50, Total Reward: 85.48, Average Profit: 9.50, Average Distance: 9.10
Episode 1200, Avg Reward: 24.48, Total Reward: 220.36, Average Profit: 24.48, Average Distance: 7.52
Episode 1300, Avg Reward: 39.85, Total Reward: 358.68, Average Profit: 39.85, Average Distance: 4.46
Episode 1400, Avg Reward: 39.85, Total Reward: 358.68, Average Profit: 39.85, Average Distance: 4.46
Episode 1500, Avg Reward: 41.03, Total Reward: 369.26, Average Profit: 41.03, Average Distance: 4.06
Episode 1600, Avg Reward: 41.43, Total Reward: 372.87, Average Profit: 41.43, Average Distance: 3.79
Episode 1700, Avg Reward: 34.30, Total Reward: 308.74, Average Profit: 34.30, Average Distance: 5.34
Episode 1800, Avg Reward: 33.98, Total Reward: 305.79, Average Profit: 33.98, Average Distance: 5.54
Episode 1900, Avg Reward: 39.01, Total Reward: 351.10, Average Profit: 39.01, Average Distance: 4.11
Episode 2000, Avg Reward: 37.75, Total Reward: 339.77, Average Profit: 37.75, Average Distance: 4.72
Episode 2100, Avg Reward: 24.38, Total Reward: 219.38, Average Profit: 24.38, Average Distance: 6.86
Episode 2200, Avg Reward: 30.74, Total Reward: 276.65, Average Profit: 30.74, Average Distance: 6.05
Episode 2300, Avg Reward: 39.85, Total Reward: 358.68, Average Profit: 39.85, Average Distance: 4.46
Episode 2400, Avg Reward: 33.28, Total Reward: 299.50, Average Profit: 33.28, Average Distance: 5.41
Episode 2500, Avg Reward: 41.43, Total Reward: 372.87, Average Profit: 41.43, Average Distance: 3.79
Episode 2600, Avg Reward: 38.25, Total Reward: 344.25, Average Profit: 38.25, Average Distance: 4.48
Episode 2700, Avg Reward: 33.68, Total Reward: 303.10, Average Profit: 33.68, Average Distance: 5.23
Episode 2800, Avg Reward: 29.53, Total Reward: 265.75, Average Profit: 29.53, Average Distance: 6.10
Episode 2900, Avg Reward: 35.23, Total Reward: 317.04, Average Profit: 35.23, Average Distance: 5.25
Episode 3000, Avg Reward: 37.65, Total Reward: 338.89, Average Profit: 37.65, Average Distance: 4.49
Episode 3100, Avg Reward: 36.24, Total Reward: 326.18, Average Profit: 36.24, Average Distance: 5.26
Episode 3200, Avg Reward: 37.25, Total Reward: 335.28, Average Profit: 37.25, Average Distance: 4.82
Episode 3300, Avg Reward: 37.65, Total Reward: 338.89, Average Profit: 37.65, Average Distance: 4.49
Episode 3400, Avg Reward: 22.68, Total Reward: 204.16, Average Profit: 22.68, Average Distance: 6.64
Episode 3500, Avg Reward: 32.90, Total Reward: 296.08, Average Profit: 32.90, Average Distance: 5.23
Episode 3600, Avg Reward: 37.25, Total Reward: 335.28, Average Profit: 37.25, Average Distance: 4.82
Episode 3700, Avg Reward: 37.25, Total Reward: 335.28, Average Profit: 37.25, Average Distance: 4.82
Episode 3800, Avg Reward: 35.26, Total Reward: 317.33, Average Profit: 35.26, Average Distance: 4.71
Episode 3900, Avg Reward: 36.43, Total Reward: 327.89, Average Profit: 36.43, Average Distance: 5.08
Episode 4000, Avg Reward: 38.75, Total Reward: 348.78, Average Profit: 38.75, Average Distance: 4.55
Episode 4100, Avg Reward: 37.25, Total Reward: 335.28, Average Profit: 37.25, Average Distance: 4.82
Episode 4200, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 4300, Avg Reward: 37.44, Total Reward: 336.92, Average Profit: 37.44, Average Distance: 4.76
Episode 4400, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 4500, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 4600, Avg Reward: 37.25, Total Reward: 335.28, Average Profit: 37.25, Average Distance: 4.82
Episode 4700, Avg Reward: 37.25, Total Reward: 335.28, Average Profit: 37.25, Average Distance: 4.82
Episode 4800, Avg Reward: 37.25, Total Reward: 335.28, Average Profit: 37.25, Average Distance: 4.82
Episode 4900, Avg Reward: 24.38, Total Reward: 219.44, Average Profit: 24.38, Average Distance: 6.12
Episode 5000, Avg Reward: 37.25, Total Reward: 335.28, Average Profit: 37.25, Average Distance: 4.82
Episode 5100, Avg Reward: 37.25, Total Reward: 335.28, Average Profit: 37.25, Average Distance: 4.82
Episode 5200, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 5300, Avg Reward: 37.15, Total Reward: 334.38, Average Profit: 37.15, Average Distance: 5.48
Episode 5400, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 5500, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 5600, Avg Reward: 37.25, Total Reward: 335.28, Average Profit: 37.25, Average Distance: 4.82
Episode 5700, Avg Reward: 37.25, Total Reward: 335.28, Average Profit: 37.25, Average Distance: 4.82
Episode 5800, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 5900, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 6000, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 6100, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 6200, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 6300, Avg Reward: 34.31, Total Reward: 308.81, Average Profit: 34.31, Average Distance: 5.45
Episode 6400, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 6500, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 6600, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 6700, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 6800, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 6900, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 7000, Avg Reward: 37.39, Total Reward: 336.55, Average Profit: 37.39, Average Distance: 4.77
Episode 7100, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 7200, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 7300, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 7400, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 7500, Avg Reward: 32.69, Total Reward: 294.22, Average Profit: 32.69, Average Distance: 5.17
Episode 7600, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 7700, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 7800, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 7900, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 8000, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 8100, Avg Reward: 39.78, Total Reward: 358.03, Average Profit: 39.78, Average Distance: 4.09
Episode 8200, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 8300, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 8400, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Episode 8500, Avg Reward: 37.25, Total Reward: 335.28, Average Profit: 37.25, Average Distance: 4.82
Episode 8600, Avg Reward: 39.55, Total Reward: 355.91, Average Profit: 39.55, Average Distance: 4.22
Traceback (most recent call last):
  File "/home/protomate/marl-ecs-course/Midsem/modified_tsp.py", line 143, in <module>
  File "/home/protomate/marl-ecs-course/Midsem/modified_tsp.py", line 63, in main
  File "/home/protomate/marl-ecs-course/Midsem/agent.py", line 109, in learn_from_memory
    state_batch = torch.FloatTensor(np.array(batch.state)).to(device)
                                    ^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
