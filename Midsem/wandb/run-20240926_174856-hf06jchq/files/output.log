Episode 0, Avg Loss: 1000.0000, Reward: -29969.669075012207, exploration: 0.7000
Episode 100, Avg Loss: 3412.9030, Reward: -78027.66552734375, exploration: 0.6663
Episode 200, Avg Loss: 6971.5879, Reward: -123516.28515625, exploration: 0.6343
Episode 300, Avg Loss: 14210.2247, Reward: -163194.30859375, exploration: 0.6039
Episode 400, Avg Loss: 22653.8914, Reward: -200644.404296875, exploration: 0.5749
Episode 500, Avg Loss: 30095.8516, Reward: -237558.75, exploration: 0.5474
Episode 600, Avg Loss: 34411.4406, Reward: -243716.14453125, exploration: 0.5212
Episode 700, Avg Loss: 52807.4250, Reward: -237418.66015625, exploration: 0.4962
Episode 800, Avg Loss: 51267.6027, Reward: -259132.2109375, exploration: 0.4725
Episode 900, Avg Loss: 59010.8070, Reward: -369362.7109375, exploration: 0.4500
Episode 1000, Avg Loss: 78353.5449, Reward: -349116.109375, exploration: 0.4285
Episode 1100, Avg Loss: 75135.4633, Reward: -264959.4453125, exploration: 0.4081
Episode 1200, Avg Loss: 82959.1301, Reward: -399165.640625, exploration: 0.3887
Episode 1300, Avg Loss: 89211.8906, Reward: -424125.8203125, exploration: 0.3702
Episode 1400, Avg Loss: 106187.1375, Reward: -446240.1171875, exploration: 0.3526
Episode 1500, Avg Loss: 103303.3109, Reward: -321437.2421875, exploration: 0.3359
Episode 1600, Avg Loss: 116468.6914, Reward: -490018.4375, exploration: 0.3200
Episode 1700, Avg Loss: 135813.7164, Reward: -346647.8828125, exploration: 0.3049
Episode 1800, Avg Loss: 132279.1219, Reward: -272068.890625, exploration: 0.2905
Episode 1900, Avg Loss: 119762.9906, Reward: -369902.34375, exploration: 0.2769
Episode 2000, Avg Loss: 119026.2609, Reward: -474314.9140625, exploration: 0.2638
Episode 2100, Avg Loss: 120425.6633, Reward: -489286.9375, exploration: 0.2515
Episode 2200, Avg Loss: 132987.9039, Reward: -301946.53125, exploration: 0.2397
Episode 2300, Avg Loss: 165040.4172, Reward: -309188.8203125, exploration: 0.2285
Episode 2400, Avg Loss: 155119.8937, Reward: -532330.015625, exploration: 0.2178
Episode 2500, Avg Loss: 134130.9937, Reward: -434576.7265625, exploration: 0.2077
Episode 2600, Avg Loss: 166732.8391, Reward: -446285.96875, exploration: 0.1980
Episode 2700, Avg Loss: 187481.8344, Reward: -456509.875, exploration: 0.1889
Episode 2800, Avg Loss: 162884.8039, Reward: -466095.671875, exploration: 0.1802
Episode 2900, Avg Loss: 147910.5000, Reward: -475970.125, exploration: 0.1719
Episode 3000, Avg Loss: 159701.5703, Reward: -612922.90625, exploration: 0.1640
Episode 3100, Avg Loss: 145111.3266, Reward: -623925.359375, exploration: 0.1565
Episode 3200, Avg Loss: 157216.1328, Reward: -635673.3125, exploration: 0.1493
Episode 3300, Avg Loss: 189400.2695, Reward: -646344.90625, exploration: 0.1425
Episode 3400, Avg Loss: 163481.9891, Reward: -378404.984375, exploration: 0.1361
Episode 3500, Avg Loss: 157013.8937, Reward: -525960.90625, exploration: 0.1299
Episode 3600, Avg Loss: 179715.5305, Reward: -678534.59375, exploration: 0.1241
Episode 3700, Avg Loss: 163966.1078, Reward: -688159.375, exploration: 0.1185
Episode 3800, Avg Loss: 162966.1750, Reward: -548174.96875, exploration: 0.1132
Episode 3900, Avg Loss: 179024.8266, Reward: -554869.921875, exploration: 0.1082
Episode 4000, Avg Loss: 172987.4641, Reward: -560908.84375, exploration: 0.1034
Episode 4100, Avg Loss: 189881.8234, Reward: -567781.546875, exploration: 0.0988
Episode 4200, Avg Loss: 166968.2773, Reward: -416688.125, exploration: 0.0945
Episode 4300, Avg Loss: 179740.1031, Reward: -582590.84375, exploration: 0.0904
Episode 4400, Avg Loss: 188695.5141, Reward: -589282.1875, exploration: 0.0865
Episode 4500, Avg Loss: 189811.3359, Reward: -595759.734375, exploration: 0.0827
Episode 4600, Avg Loss: 186039.9469, Reward: -601965.65625, exploration: 0.0792
Episode 4700, Avg Loss: 173998.6156, Reward: -777987.1875, exploration: 0.0758
Episode 4800, Avg Loss: 211164.3641, Reward: -443025.203125, exploration: 0.0726
Episode 4900, Avg Loss: 175803.1828, Reward: -447788.609375, exploration: 0.0695
Episode 5000, Avg Loss: 188036.2094, Reward: -628083.84375, exploration: 0.0666
Episode 5100, Avg Loss: 208641.9328, Reward: -278016.09375, exploration: 0.0639
Episode 5200, Avg Loss: 207353.8469, Reward: -280293.609375, exploration: 0.0612
Episode 5300, Avg Loss: 188761.0594, Reward: -647110.421875, exploration: 0.0587
Episode 5400, Avg Loss: 214567.2547, Reward: -469241.609375, exploration: 0.0564
Episode 5500, Avg Loss: 209063.7328, Reward: -473140.328125, exploration: 0.0541
Episode 5600, Avg Loss: 196982.7672, Reward: -854042.640625, exploration: 0.0520
Episode 5700, Avg Loss: 196193.2313, Reward: -480604.203125, exploration: 0.0499
Episode 5800, Avg Loss: 187777.1484, Reward: -677102.125, exploration: 0.0480
Episode 5900, Avg Loss: 210361.0344, Reward: -488436.171875, exploration: 0.0461
Episode 6000, Avg Loss: 196191.4875, Reward: -492473.796875, exploration: 0.0444
Episode 6100, Avg Loss: 181195.7703, Reward: -693766.40625, exploration: 0.0427
Episode 6200, Avg Loss: 173575.3023, Reward: -299720.359375, exploration: 0.0411
Episode 6300, Avg Loss: 218163.1859, Reward: -503184.859375, exploration: 0.0396
Episode 6400, Avg Loss: 195052.6250, Reward: -506866.390625, exploration: 0.0381
Episode 6500, Avg Loss: 187897.6258, Reward: -715246.015625, exploration: 0.0368
Episode 6600, Avg Loss: 191744.9438, Reward: -513656.453125, exploration: 0.0354
Episode 6700, Avg Loss: 190677.0305, Reward: -725532.828125, exploration: 0.0342
Episode 6800, Avg Loss: 183091.2875, Reward: -520441.859375, exploration: 0.0330
Episode 6900, Avg Loss: 203069.0016, Reward: -523430.984375, exploration: 0.0319
Episode 7000, Avg Loss: 162706.2766, Reward: -526591.296875, exploration: 0.0308
Episode 7100, Avg Loss: 209723.5922, Reward: -530238.640625, exploration: 0.0298
Episode 7200, Avg Loss: 212797.8656, Reward: -533512.921875, exploration: 0.0289
Episode 7300, Avg Loss: 186654.7766, Reward: -536805.328125, exploration: 0.0279
Episode 7400, Avg Loss: 180652.1055, Reward: -540173.328125, exploration: 0.0271
Episode 7500, Avg Loss: 208015.6398, Reward: -543438.296875, exploration: 0.0262
Episode 7600, Avg Loss: 181936.5734, Reward: -546457.515625, exploration: 0.0254
Episode 7700, Avg Loss: 205485.2938, Reward: -549279.453125, exploration: 0.0247
Episode 7800, Avg Loss: 188262.0734, Reward: -778845.4375, exploration: 0.0240
Episode 7900, Avg Loss: 202666.3625, Reward: -555943.765625, exploration: 0.0233
Episode 8000, Avg Loss: 166132.3805, Reward: -788594.34375, exploration: 0.0226
Episode 8100, Avg Loss: 169651.3477, Reward: -562025.640625, exploration: 0.0220
Episode 8200, Avg Loss: 190925.0109, Reward: -332505.453125, exploration: 0.0214
Episode 8300, Avg Loss: 172987.6203, Reward: -567985.265625, exploration: 0.0209
Episode 8400, Avg Loss: 183361.4922, Reward: -570663.578125, exploration: 0.0203
Episode 8500, Avg Loss: 174988.9336, Reward: -573643.484375, exploration: 0.0198
Episode 8600, Avg Loss: 199855.3500, Reward: -576685.109375, exploration: 0.0194
Episode 8700, Avg Loss: 184640.3141, Reward: -579717.515625, exploration: 0.0189
Episode 8800, Avg Loss: 173305.2383, Reward: -582924.890625, exploration: 0.0185
Episode 8900, Avg Loss: 199107.7023, Reward: -586043.203125, exploration: 0.0181
Episode 9000, Avg Loss: 199366.2992, Reward: -589054.203125, exploration: 0.0177
Episode 9100, Avg Loss: 183197.4234, Reward: -838359.234375, exploration: 0.0173
Episode 9200, Avg Loss: 178957.6609, Reward: -595357.703125, exploration: 0.0169
Episode 9300, Avg Loss: 206209.1766, Reward: -598084.484375, exploration: 0.0166
Episode 9400, Avg Loss: 197172.6688, Reward: -601256.296875, exploration: 0.0163
Episode 9500, Avg Loss: 196569.9844, Reward: -604551.21875, exploration: 0.0160
Episode 9600, Avg Loss: 177624.8492, Reward: -608106.5, exploration: 0.0157
Episode 9700, Avg Loss: 199508.8719, Reward: -355616.6875, exploration: 0.0154
Episode 9800, Avg Loss: 178878.1516, Reward: -614439.78125, exploration: 0.0151
Episode 9900, Avg Loss: 190965.7000, Reward: -617844.09375, exploration: 0.0149
Episode 10000, Avg Loss: 186989.8188, Reward: -621362.34375, exploration: 0.0146
Episode 10100, Avg Loss: 201262.3469, Reward: -624290.625, exploration: 0.0144
Episode 10200, Avg Loss: 197549.6297, Reward: -627456.84375, exploration: 0.0142
Episode 10300, Avg Loss: 157994.5016, Reward: -630489.90625, exploration: 0.0140
Episode 10400, Avg Loss: 191866.2930, Reward: -366766.375, exploration: 0.0138
Episode 10500, Avg Loss: 155024.0641, Reward: -637258.34375, exploration: 0.0136
Episode 10600, Avg Loss: 173121.0875, Reward: -640876.34375, exploration: 0.0134
Episode 10700, Avg Loss: 171840.7922, Reward: -644159.4375, exploration: 0.0133
Episode 10800, Avg Loss: 168047.2977, Reward: -647407.71875, exploration: 0.0131
Episode 10900, Avg Loss: 183445.0234, Reward: -650572.65625, exploration: 0.0130
Episode 11000, Avg Loss: 182016.7344, Reward: -653854.71875, exploration: 0.0128
Episode 11100, Avg Loss: 171271.2023, Reward: -378351.125, exploration: 0.0127
Episode 11200, Avg Loss: 150006.2062, Reward: -659772.5, exploration: 0.0126
Episode 11300, Avg Loss: 185167.6773, Reward: -944096.875, exploration: 0.0124
Episode 11400, Avg Loss: 162662.5953, Reward: -665938.1875, exploration: 0.0123
Episode 11500, Avg Loss: 176711.4500, Reward: -669240.4375, exploration: 0.0122
Episode 11600, Avg Loss: 185245.9703, Reward: -672243.375, exploration: 0.0121
Episode 11700, Avg Loss: 177860.4414, Reward: -675283.25, exploration: 0.0120
Episode 11800, Avg Loss: 172161.0523, Reward: -678119.0, exploration: 0.0119
Episode 11900, Avg Loss: 171942.1352, Reward: -681271.84375, exploration: 0.0118
Episode 12000, Avg Loss: 160990.7047, Reward: -684392.15625, exploration: 0.0117
Episode 12100, Avg Loss: 192572.2812, Reward: -687632.15625, exploration: 0.0116
Episode 12200, Avg Loss: 185665.9781, Reward: -690502.5625, exploration: 0.0115
Episode 12300, Avg Loss: 181404.9344, Reward: -693548.125, exploration: 0.0115
Episode 12400, Avg Loss: 169371.5781, Reward: -994830.8125, exploration: 0.0114
Episode 12500, Avg Loss: 170584.7109, Reward: -699587.90625, exploration: 0.0113
Episode 12600, Avg Loss: 185455.0297, Reward: -702467.6875, exploration: 0.0113
Episode 12700, Avg Loss: 188597.6812, Reward: -705298.8125, exploration: 0.0112
Episode 12800, Avg Loss: 174575.6453, Reward: -707882.15625, exploration: 0.0111
Episode 12900, Avg Loss: 176275.4672, Reward: -710433.875, exploration: 0.0111
Episode 13000, Avg Loss: 171575.8391, Reward: -713400.75, exploration: 0.0110
Episode 13100, Avg Loss: 177072.1617, Reward: -716261.3125, exploration: 0.0110
Episode 13200, Avg Loss: 168019.5305, Reward: -1028052.375, exploration: 0.0109
Episode 13300, Avg Loss: 179882.5836, Reward: -1031673.5, exploration: 0.0109
Episode 13400, Avg Loss: 183372.0078, Reward: -411709.65625, exploration: 0.0108
Episode 13500, Avg Loss: 164152.8492, Reward: -1038428.09375, exploration: 0.0108
Episode 13600, Avg Loss: 181222.1867, Reward: -728278.25, exploration: 0.0108
Episode 13700, Avg Loss: 184584.1313, Reward: -730498.34375, exploration: 0.0107
Episode 13800, Avg Loss: 188164.9094, Reward: -733208.40625, exploration: 0.0107
Episode 13900, Avg Loss: 182445.3984, Reward: -735886.40625, exploration: 0.0107
Episode 14000, Avg Loss: 191757.0734, Reward: -419206.9375, exploration: 0.0106
Episode 14100, Avg Loss: 175113.0883, Reward: -1061643.28125, exploration: 0.0106
Episode 14200, Avg Loss: 180482.1859, Reward: -744404.65625, exploration: 0.0106
Episode 14300, Avg Loss: 162409.5914, Reward: -747784.40625, exploration: 0.0105
Episode 14400, Avg Loss: 187297.8305, Reward: -750306.65625, exploration: 0.0105
Episode 14500, Avg Loss: 153438.4500, Reward: -753404.53125, exploration: 0.0105
Episode 14600, Avg Loss: 167122.8484, Reward: -428252.0, exploration: 0.0105
Episode 14700, Avg Loss: 163731.9977, Reward: -759337.78125, exploration: 0.0104
Episode 14800, Avg Loss: 172870.7367, Reward: -762781.625, exploration: 0.0104
Episode 14900, Avg Loss: 172304.6266, Reward: -766001.15625, exploration: 0.0104
Episode 15000, Avg Loss: 176805.9438, Reward: -769200.875, exploration: 0.0104
Episode 15100, Avg Loss: 173760.6734, Reward: -772248.9375, exploration: 0.0104
Episode 15200, Avg Loss: 156963.9148, Reward: -437818.8125, exploration: 0.0103
Episode 15300, Avg Loss: 180126.2922, Reward: -778919.46875, exploration: 0.0103
Episode 15400, Avg Loss: 146395.9672, Reward: -781933.03125, exploration: 0.0103
Episode 15500, Avg Loss: 174128.1383, Reward: -785199.71875, exploration: 0.0103
Episode 15600, Avg Loss: 166038.6117, Reward: -444040.625, exploration: 0.0103
Episode 15700, Avg Loss: 141068.8180, Reward: -791297.71875, exploration: 0.0103
Episode 15800, Avg Loss: 151195.3172, Reward: -447179.90625, exploration: 0.0103
Episode 15900, Avg Loss: 156634.4516, Reward: -797110.28125, exploration: 0.0102
Episode 16000, Avg Loss: 164009.0898, Reward: -449851.65625, exploration: 0.0102
Episode 16100, Avg Loss: 169261.8977, Reward: -802855.0625, exploration: 0.0102
Episode 16200, Avg Loss: 166922.0547, Reward: -806023.9375, exploration: 0.0102
Traceback (most recent call last):
  File "/home/protomate/marl-ecs-course/Midsem/modified_tsp.py", line 79, in <module>
    main()
  File "/home/protomate/marl-ecs-course/Midsem/modified_tsp.py", line 52, in main
    loss = agent.learn_from_memory(batch_size=batchSize)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/protomate/marl-ecs-course/Midsem/agent.py", line 91, in learn_from_memory
    action_batch = torch.LongTensor(batch.action).unsqueeze(1).to(device)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/protomate/marl-ecs-course/Midsem/agent.py", line 24, in sample
    return random.sample(self.memory, batch_size)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/protomate/.pyenv/versions/3.12.4/lib/python3.12/random.py", line 451, in sample
    result[i] = population[j]
    ~~~~~~^^^
KeyboardInterrupt
